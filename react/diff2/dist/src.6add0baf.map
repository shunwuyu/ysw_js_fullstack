{"version":3,"sources":["src/react/create-element.js","src/react-dom/dom.js","src/react-dom/render.js","src/react/component.js","src/react/index.js","src/react-dom/index.js","src/index.js"],"names":["createElement","tag","attrs","children","key","setAttribute","dom","name","value","test","console","log","toLowerCase","style","cssText","removeAttribute","renderComponent","render","_render","vnode","undefined","String","textNode","document","createTextNode","component","createComponent","setComponentProps","base","Object","keys","forEach","child","props","renderer","parentNode","replaceChild","_component","inst","prototype","Component","constructor","container","appendChild","isReactComponent","state","stateChange","assign","Counter","num","onClick","setState","React","ReactDOM","fontSize","fontWeight","getElementById"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AF3BA;;;;AACA;;;;;;kBACe;AACbxD,wCADa;AAEbwC;AAFa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACFf;;kBACe;AACbvB;AADa","file":"src.6add0baf.map","sourceRoot":"..","sourcesContent":["function createElement(tag, attrs, ...children) {\n  attrs = attrs || {};\n\n  // console.log(tag, attrs, children);\n  return {\n    tag, \n    attrs,\n    children,\n    key: attrs.key || null\n  }\n}\n\nexport default createElement;","export function setAttribute(dom, name, value) {\n  // console.log(name, value);\n  if (name === 'className') name = 'class';\n  // console.log(name, dom);\n  if (/on\\w+/.test(name)) {\n    console.log(name, value);\n    name = name.toLowerCase();\n    dom[name] = value;\n  } else if ( name === 'style' ) {\n    console.log(typeof value)\n    if (!value || typeof value === 'string') {\n      dom.style.cssText = value || '';\n    } else if (value && typeof value === 'object') {\n      console.log(name, value);\n      for (let name in value) {\n        dom.style[name] = typeof value[name] === 'number'? value[name] + 'px': value[name];\n      }\n    }\n  } else {\n    if (name in dom) {\n      dom[name] = value || ''\n    }\n    if (value) {\n      dom.setAttribute(name, value);\n    } else {\n      dom.removeAttribute(name, value);\n    }\n  }\n}","import { setAttribute } from './dom.js'\nimport Component from '../react/component.js';\n/**\n * 将虚拟DOM 变真实DOM\n * @params vnode 虚拟DOM, \n * @return 返回DOM\n */\n\nfunction _render (vnode) {\n  // console.log(vnode);\n  // return document.createTextNode('render');\n  // 1. 递归 将结点转成dom ,子结点递归，出口就是文本结点\n  // 2. 节点类型 三种： \n  // 文本结点 return createTextNode()\n  // 标签结点 createElement attr chilren设置（递归_render）\n  // 3. Component render(return jsx)\n  // render()\n  if (vnode === undefined || vnode === null || typeof vnode === 'boolean')\n  vnode = '';\n  \n  if (typeof vnode === 'number') {\n    console.log(vnode);\n    vnode = String(vnode);\n  }\n\n  if (typeof vnode === 'string') {\n    let textNode = document.createTextNode(vnode);\n    return textNode;\n  }\n  // <Counter />  不是正常标签, vnode.tag= function Counter(){}\n  if (typeof vnode.tag === 'function') {\n    // console.log(vnode);\n    // return document.createTextNode('component');\n    const component = createComponent(vnode.tag, vnode.attrs);\n    setComponentProps(component, vnode.attrs);\n    return component.base;\n  }\n\n  const dom = document.createElement(vnode.tag);\n  if (vnode.attrs) {\n    Object.keys(vnode.attrs).forEach(key => {\n      const value = vnode.attrs[key];\n      setAttribute(dom, key, value);\n    })\n  }\n\n  if (vnode.children) {\n    vnode.children.forEach(child => render(child, dom));\n  }\n\n  return dom;\n}\n\nfunction setComponentProps (component, props) {\n  component.props = props;\n  renderComponent(component);\n}\n\n// 将component里的jsx转为DOM 他还会在setState时调用 \nexport function renderComponent(component) {\n  let base; //jsx=> DOM\n  const renderer = component.render();\n  base = _render(renderer);\n  // 非第一次渲染组件\n  if (component.base && component.base.parentNode) {\n    component.base.parentNode.replaceChild(base, component.base)\n  }\n  component.base = base;\n  base._component = component;\n}\n\nfunction createComponent(component, props) {\n  let inst;\n  if (component.prototype && component.prototype.render) {\n    inst = new component(props);\n  } else {\n    inst = new Component(props);\n    inst.constructor = component;\n    inst.render = function() {\n      return this.constructor(props);\n    }  \n  }\n  return inst;\n}\nexport function render(vnode, container) {\n  return container.appendChild(_render(vnode));\n}","import { renderComponent } from \"../react-dom/render\";\nclass Component {\n  constructor (props = {}) {\n    this.isReactComponent = true;\n    this.state = {};\n    this.props = props;\n  }\n\n  setState(stateChange) {\n    Object.assign(this.state, stateChange);\n    // console.log(stateChange);\n    // 更新DOM\n    renderComponent(this);\n  }\n}\n\nexport default Component;","import createElement from './create-element.js'\nimport Component from './component.js'\nexport default {\n  createElement,\n  Component\n}","import {render} from './render'\nexport default {\n  render\n}","import React from './react';\nimport ReactDOM from './react-dom';\n\nclass Counter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      num: 1\n    }\n  }\n\n  render () {\n    return (\n      <div>\n        <h1>count:{ this.state.num }</h1>\n        <button onClick={() => this.onClick()}>add</button>\n      </div>\n    )\n  }\n  onClick () {\n    // console.log(this);\n    this.setState({\n      num: this.state.num + 1\n    })\n  }\n}\n\nReactDOM.render(\n  <div>\n    Hello\n    <span className='rt' onClick=\"console.log('zz');\"\n    style={{fontSize: 20, fontWeight: 'bold'}}\n    > World!</span>\n    <Counter/>\n  </div>\n  ,\n   document.getElementById('root'))"]}